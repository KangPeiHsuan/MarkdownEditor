# Word 匯出功能測試指南

## 🎯 測試目的
驗證 Word 匯出功能經過第四輪深度修正後是否能正常運作。

## 🚀 測試準備

### 1. 啟動應用程式
```bash
cd MarkdownEditor
dotnet run
```

### 2. 開啟瀏覽器
訪問：`http://localhost:5000` 或 `https://localhost:5001`

## 📋 測試步驟

### 測試 1：空筆記匯出測試
1. 建立一個新筆記（內容留空）
2. 儲存筆記
3. 點擊「匯出為 Word」
4. **預期結果**：
   - 成功下載 Word 檔案
   - 檔案名稱包含時間戳記：`測試_筆記名稱_20250109_HHMMSS.docx`
   - 開啟檔案後看到：
     - 標題：「[測試] 筆記名稱」
     - 分隔線
     - 測試內容說明
     - 「原始內容為空」提示
     - 格式測試內容（粗體、斜體、列表）
     - 生成時間和筆記ID

### 測試 2：包含內容的筆記匯出測試
1. 建立筆記，內容為：
```markdown
# 我的測試筆記

這是一個包含**粗體**和*斜體*的段落。

## 功能測試
- 列表項目 1
- 列表項目 2

> 這是引用文字
```
2. 儲存筆記
3. 點擊「匯出為 Word」
4. **預期結果**：
   - 成功下載 Word 檔案
   - 開啟檔案後看到：
     - 完整的測試標題
     - 原始筆記內容（包含上述 Markdown 內容）
     - 額外的格式測試內容
     - 生成時間和筆記ID

### 測試 3：中文內容測試
1. 建立筆記，內容為：
```markdown
# 中文測試筆記

這是**中文粗體**測試。
這是*中文斜體*測試。

## 中文功能
- 中文列表項目一
- 中文列表項目二

> 中文引用測試
```
2. 匯出為 Word
3. **預期結果**：所有中文字元正確顯示

## ✅ 成功標準

### 基本要求
- [ ] Word 檔案能夠成功下載
- [ ] 檔案不是空白的
- [ ] 能夠用 Word 或相容軟體開啟

### 內容驗證
- [ ] 看到標題信息
- [ ] 看到分隔線（等號線）
- [ ] 看到豐富的測試內容
- [ ] 看到生成時間戳記
- [ ] 看到筆記ID
- [ ] 原始筆記內容正確顯示（如果有）

### 格式驗證
- [ ] 標題使用不同字體大小
- [ ] 粗體文字正確顯示
- [ ] 斜體文字正確顯示
- [ ] 列表格式正確
- [ ] 引用格式正確

## 🐞 故障排除

### 問題 1：仍然下載空白檔案
**可能原因**：
- OpenXml 套件版本問題
- 系統環境問題

**解決方案**：
1. 檢查控制台是否有錯誤訊息
2. 嘗試重新建置專案：`dotnet build`
3. 檢查是否有其他程序占用 Word 檔案

### 問題 2：檔案無法開啟
**可能原因**：
- 檔案格式損壞
- Word 軟體問題

**解決方案**：
1. 嘗試用其他軟體開啟（如 LibreOffice）
2. 檢查檔案大小是否為 0 KB
3. 重新匯出檔案

### 問題 3：內容顯示不完整
**檢查項目**：
- 是否看到「生成時間」？
- 是否看到「筆記ID」？
- 是否看到測試內容？

如果以上都沒有，表示基本文檔生成有問題。

## 📞 回報結果

請在測試後回報：
1. **測試結果**：成功/失敗
2. **具體狀況**：
   - 能否下載檔案？
   - 檔案大小是否正常？
   - 開啟後看到什麼內容？
3. **錯誤訊息**（如果有）
4. **使用的 Word 軟體版本**

## 🔄 第四輪修正特色

本次修正的特點：
- **極簡化架構**：移除所有可能出錯的複雜邏輯
- **強制內容**：確保每個匯出的檔案都有豐富的測試內容
- **診斷信息**：包含時間戳記和筆記ID用於追蹤
- **錯誤檢測**：增加檔案生成失敗的檢查

如果這個版本仍然有問題，我們將考慮：
1. 更換 Word 匯出套件
2. 使用 RTF 格式替代
3. 檢查系統環境配置

---

**測試版本**：第四輪修正版  
**更新日期**：2025-01-09 